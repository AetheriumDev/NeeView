
<h1>NeeView Script Manual</h1>

<h2> Overview </h2>
<p>
    Extend the command with a script. You can change the settings, execute multiple commands at once, or execute them as separate commands with changed command parameters.
</p>
<p>
    Scripting is disabled by default. Set and enable on the Scripts page of Options.

    <ul>
        <li>The script grammar is Javascript (ECMA 5.1).</li>
        <li><a href="https://github.com/sebastienros/jint">Jint</a> is used for the script engine.</li>
        <li>The file extension is .nvjs.</li>
        <li>The character code is UTF8. No BOM is recommended.</li>
    </ul>
</p>
<p>
    You can qualify the command with the doc comments at the top of the file. The keys are not case sensitive.

    <table class="table-slim table-topless">
        <tr><th>Key</th><th>Summary</th></tr>
        <tr><td>@name</td><td>Command name</td></tr>
        <tr><td>@description</td><td>Command description</td></tr>
        <tr><td>@shortCutKey</td><td>Default shotcuts</td></tr>
        <tr><td>@mouseGesture</td><td>Default mouse gestures</td></tr>
        <tr><td>@touchGesture</td><td>Default touch operation</td></tr>
    </table>
</p>


<h2>Command script</h2>
<p>
    If the script file is placed in the script folder, it can be used as a command. One file is one command.

    <ul>
        <li>Shortcuts can be set in the "Command settings" of the Options like normal commands. </li>
        <li>The file name becomes the command name.</li>
    </ul>
</p>

<h2>Event script</h2>
<p>
    A specially named script file will be executed automatically.

    <table class="table-slim">
        <tr><td>OnBookLoaded.nvjs</td><td>Runs when you open the book.</td></tr>
    </table>
</p>

<h2>Console</h2>
<p>
    A console for testing scripts. To open it, select "Options > Open console" from the menu.
</p>
<h4>Console-only command</h4>
<p>
    <table class="table-slim">
        <tr><td>cls</td><td>Clear screen (Ctrl+L)</td></tr>
        <tr><td>exit</td><td>Close console</td></tr>
        <tr><td>help, ?</td><td>Open this script help</td></tr>
    </table>
</p>
