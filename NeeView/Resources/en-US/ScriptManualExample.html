<hr />

<h2>Script examples</h2>

Here are some example scripts.
For other samples, refer to <a href="https://bitbucket.org/neelabo/neeview.scriptsamples/">here</a>.

<h3>Execute "External app" command by temporarily changing the executable file and arguments</h3>
<p>
    <pre>OpenMsPaint.nvjs<code>
    // @name MS Paint
    // @description Open the file with MS Paint.

    param = {
        "Command": "mspaint.exe",
        "Parameter": "\"$File\""
    }
    nv.Command.OpenExternalApp.Patch(param).Execute()
    </code></pre>
</p>


<h3>Open display page in new NeeView</h3>
<p>
    <pre>OpenNeeView.nvjs<code>
    // @name Open in NeeView
    // @description Opens the display page in a new NeeView.

    nv.Command.SaveSetting.Execute() // Save to keep the same settings

    param = {
        "Command": "$NeeView", // Special way to show NeeView's own path
        "Parameter": "-n \"$File\"",
        "MultiPagePolicy": "Once",
        "ArchivePolicy": "SendArchivePath"
    }
    nv.Command.OpenExternalApp.Patch(param).Execute()
</code></pre>
</p>


<h3>ON / OFF of unsharp mask</h3>
<p>
    <pre>ToggleUnsharpMask.nvjs<code>
    // @name Unsharp mask ON/OFF
    // @description Switching of unsharp mask. Show warning when resize filter is not enabled

    if (nv.Config.ImageResizeFilter.IsEnabled) {
        nv.Config.ImageResizeFilter.IsUnsharpMaskEnabled = !nv.Config.ImageResizeFilter.IsUnsharpMaskEnabled
        if (nv.Config.ImageResizeFilter.IsUnsharpMaskEnabled) {
            nv.ShowMessage("UnsharpMask ON")
        }
        else {
            nv.ShowMessage("UnsharpMask OFF")
        }
    }
    else {
        nv.ShowMessage("ResizeFilter is not active")
    }
</code></pre>
</p>


<h3>If the path of the newly opened book contains "English", open it to the left, otherwise open it to the right</h3>
<p>
    <pre>OnBookLoaded.nvjs<code>
    // @name Book loaded processing
    // @description Event when the book is opened

    if (nv.Book.IsNew) {
      if (nv.Book.Path.match(/English/) != null) {
        nv.Book.Config.BookReadOrder = "LeftToRight"
      }
      else {
        nv.Book.Config.BookReadOrder = "RightToLeft"
      }
    }
  </code></pre>
</p>

<h3>Change the operation method when a video file is opened</h3>
<p>
    <pre>OnBookLoaded.nvjs<code>
    // @name Book loaded processing
    // @description Event when the book is opened

    if (nv.Book.IsMedia) {
      // Video: Click to play / stop, double-click to switch full screen
      nv.Command.ToggleMediaPlay.ShortCutKey = "LeftClick"
      nv.Command.Script_ToggleFullScreenAndMediaPlay.ShortCutKey = "LeftDoubleClick"
      nv.Command.NextPage.ShortCutKey = "Left"
    }
    else {
      // Normal: Standard setting
      nv.Command.ToggleMediaPlay.ShortCutKey = null
      nv.Command.Script_ToggleFullScreenAndMediaPlay.ShortCutKey = null
      nv.Command.NextPage.ShortCutKey = "Left,LeftClick"
    }
  </code></pre>
</p>

<p>
    <pre>ToggleFullScreenAndMediaPlay.nvjs<code>
    // @name Full screen & video playback
    // @description Switch full screen and video playback at the same time

    nv.Command.ToggleFullScreen.Execute()
    nv.Command.ToggleMediaPlay.Execute()
  </code></pre>
</p>
