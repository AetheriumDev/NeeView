<hr />

<h2>スクリプトの例</h2>


<h3>実行ファイルと引数を一時的に変更して「外部アプリで開く」コマンドを実行する</h3>
<p>
    <pre>OpenMsPaint.nvjs<code>
    // @name MSペイント
    // @description MSペイントでファイルを開きます。

    param = {
        "Command": "mspaint.exe",
        "Parameter": "\"$File\""
    }
    nv.Command.OpenExternalApp.Patch(param).Execute()
    </code></pre>
</p>


<h3>表示ページを新しいNeeViewで開く</h3>
<p>
    <pre>OpenNeeView.nvjs<code>
    // @name NeeViewで開く
    // @description 表示ページを新しいNeeViewで開きます。

    nv.Command.SaveSetting.Execute() // 設定を同じにするため保存を実行

    param = {
        "Command": "$NeeView", // NeeView自身のパスを示す特殊な書き方
        "Parameter": "-n \"$File\"",
        "MultiPagePolicy": "Once",
        "ArchivePolicy": "SendArchivePath"
    }
    nv.Command.OpenExternalApp.Patch(param).Execute()
</code></pre>
</p>


<h3>アンシャープマスクのON/OFF</h3>
<p>
    <pre>ToggleUnsharpMask.nvjs<code>
    // @name アンシャープマスクON/OFF
    // @description アンシャープマスクの切り替え。リサイズフィルターが有効でないときは警告を表示する

    if (nv.Config.ImageResizeFilter.IsEnabled) {
        nv.Config.ImageResizeFilter.IsUnsharpMaskEnabled = !nv.Config.ImageResizeFilter.IsUnsharpMaskEnabled
        if (nv.Config.ImageResizeFilter.IsUnsharpMaskEnabled) {
            nv.ShowMessage("UnsharpMask ON")
        }
        else {
            nv.ShowMessage("UnsharpMask OFF")
        }
    }
    else {
        nv.ShowMessage("ResizeFilter is not active")
    }
</code></pre>
</p>


<h3>新しく開いたブックのパスに"English"が含まれていたら左開き、それ以外は右開きにする</h3>
<p>
    <pre>OnBookLoaded.nvjs<code>
    // @name ブック開始処理
    // @description ブックを開いたときのイベント

    if (nv.Book.IsNew) {
      if (nv.Book.Path.match(/English/) != null) {
        nv.Book.Config.BookReadOrder = "LeftToRight"
      }
      else {
        nv.Book.Config.BookReadOrder = "RightToLeft"
      }
    }
  </code></pre>
</p>

<h3>動画ファイルを開いたときに操作方法を変更する</h3>
<p>
    <pre>OnBookLoaded.nvjs<code>
    // @name ブック開始処理
    // @description ブックを開いたときのイベント

    if (nv.Book.IsMedia) {
      // 動画：クリックで再生/停止、ダブルクリックでフルスクリーンの切り替え
      nv.Command.ToggleMediaPlay.ShortCutKey = "LeftClick"
      nv.Command.Script_ToggleFullScreenAndMediaPlay.ShortCutKey = "LeftDoubleClick"
      nv.Command.NextPage.ShortCutKey = "Left"
    }
    else {
      // 通常：標準設定
      nv.Command.ToggleMediaPlay.ShortCutKey = null
      nv.Command.Script_ToggleFullScreenAndMediaPlay.ShortCutKey = null
      nv.Command.NextPage.ShortCutKey = "Left,LeftClick"
    }
  </code></pre>
</p>

<p>
    <pre>ToggleFullScreenAndMediaPlay.nvjs<code>
    // @name フルスクリーン＆動画再生
    // @description フルスクリーンと動画再生を同時に切り替え

    nv.Command.ToggleFullScreen.Execute()
    nv.Command.ToggleMediaPlay.Execute()
  </code></pre>
</p>
