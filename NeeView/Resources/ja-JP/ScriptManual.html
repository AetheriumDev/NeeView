
<h1>NeeView スクリプトマニュアル</h1>

<h2> 概要 </h2>
<p>
    スクリプトでコマンドを拡張します。設定を変更したり、複数のコマンドをまとめて実行したり、コマンドパラメーターを変更した別のコマンドとして実行することができます。
</p>
<p>
    スクリプト機能はデフォルトでは無効になっています。設定の「スクリプト」ページで設定して有効にします。

    <ul>
        <li>スクリプトは Javascript (ECMA 5.1) で記述します。</li>
        <li>スクリプトエンジンに <a href="https://github.com/sebastienros/jint">Jint</a> を使用しています。</li>
        <li>ファイル拡張子は .nvjs です。</li>
        <li>文字コードはUTF8です。BOM無しを推奨します。</li>
    </ul>
</p>
<p>
    ファイル先頭のドックコメントでコマンドを修飾できます。キーは大文字小文字を区別しません。

    <table class="table-slim table-topless">
        <tr><th>キー</th><th>概要</th></tr>
        <tr><td>@Name</td><td>コマンド名</td></tr>
        <tr><td>@Description</td><td>コマンド説明</td></tr>
        <tr><td>@ShortCutKey</td><td>既定のショートカット</td></tr>
        <tr><td>@MouseGesture</td><td>既定のマウスジェスチャー</td></tr>
        <tr><td>@TouchGesture</td><td>既定のタッチ操作</td></tr>
    </table>
</p>

<h2>コマンドスクリプト</h2>
<p>
    スクリプトフォルダーにスクリプトファイルが配置されているとコマンドとして使用可能になります。
    １ファイルが１コマンドになります。

    <ul>
        <li>設定の「コマンド設定」で通常のコマンドと同様にショートカットを設定できます。</li>
        <li>ファイル名がコマンド名になります。</li>
    </ul>
</p>

<h2>イベントスクリプト</h2>
<p>
    特定の名前のスクリプトファイルは自動的に実行されます。

    <table class="table-slim">
        <tr><td>OnBookLoaded.nvjs</td><td>ブックを開いたときに実行されます。</td></tr>
    </table>
</p>

<h2>コンソール</h2>
<p>
    スクリプトのテストをするためのコンソールです。メニューの「オプション > コンソールを開く」で開きます。
</p>
<h4>コンソール専用コマンド</h4>

<p>
    <table class="table-slim">
        <tr><td>cls</td><td>画面のクリア(Ctrl+L)</td></tr>
        <tr><td>exit</td><td>コンソールを閉じる</td></tr>
        <tr><td>help, ?</td><td>スクリプトヘルプを開く</td></tr>
    </table>
</p>
