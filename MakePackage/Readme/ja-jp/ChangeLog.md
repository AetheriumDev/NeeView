## 更新履歴

### 40.1
(2023-12-06)

#### 不具合修正

- 旧バージョンでドラッグ操作「移動 (スケール依存)」のパラメーターを指定ていた場合、データが読み込めなくなる不具合修正
- 2 ページ表示なのに 1 ページしか表示されないことがある不具合修正
- 本棚の検索で除外パターンが適用されない不具合修正
- ヘルプの誤記修正

----

### 40.0
(2023-12-05)

#### 重要な変更

- 動作環境が Windows 10, Windows 11, 64bit OS のみになりました。Windows7, Windows8.1 や 32bit OS のパッケージはバージョン 40.0 以降は提供されません。
- .NET8 で動作しています。このフレームワークはアプリの一部として含まれています。別途インストールする必要はありません。
- 既に .NET8 がインストールされている環境のために、.NET8 を含まないパッケージ "NeeView40-fd.zip" を用意しました。Susie プラグインを使用する場合は x86 用の .NET8 ランタイムのインストールも必要になります。
- 大幅にファイル構成が変更されているので、ZIP版では上書き更新ができません。エクスポート/インポートを使用してデータを移行してください。インストーラー版はそのまま更新可能です。

#### ユーザー データ保存場所

- ZIP版のユーザー データ保存場所を Profile フォルダーにまとめました。
- ユーザー データの既定の保存場所を環境変数 NEEVIEW_PROFILE で指定できます。

#### ページ表示処理の刷新

パノラ マモード実装にあわせてページ表示処理を作り直しました。なるべく以前の動作と合わせていますが、スケールや回転変更時の挙動が変わっている可能性があります。

- ページをつなげて表示する「パノラマ」モードを追加。
- ページ接続方向の縦横を切り替えられるようにした。
- 各種スクロール コマンドのスクロール時間設定を１つにまとめた。 (設定 > 画像操作 > スクロール時間)
- スクロール アニメーションでページを切り替えられるようにした。 (設定 > 画像操作 > ページ移動時間)

#### メインビュー ウィンドウ

メインビュー ウィンドウは単にウィンドウ表示するだけでなく、新しい表示モードして機能するようになりました。

- メインビュー ウィンドウ切り替えコマンドに F12 ショートカットを割り当てた。
- メインビュー ウィンドウ表示時にメイン領域にページリストを表示する設定追加。 (設定 > メインビュー)
- メインビュー ウィンドウ自動非表示設定追加。 (設定 > メインビュー)
- メインビュー ウィンドウの閉じるボタンでは最小化するように挙動を変更。
- メインビュー ウィンドウで ESC キーを押したときに最小化するようにした。
- メインビュー ウィンドウに「自動ウィンドウサイズ調整」追加。 (メインビュー ウィンドウ > タイトルバーのコンテキストメニュー)
- ページリストにページ選択でメインビューにフォーカスを移す設定追加。 (ページリスト パネル > 詳細メニュー)

#### 検索機能の強化

- 各種パネルに検索ボックス追加。
- 検索オプション追加。ブックマークや画像に含まれるタグで検索可能になりました。詳細は「検索オプション ヘルプ」を参照してください。
- 検索履歴の個別削除ボタン追加。
- 検索履歴サイズ設定追加。 (設定 > 全般)

#### 動画再生機能の強化

- 動画再生に libVLC (VLC media player) を使用する設定追加。 (設定 > 動画)
- 動画をページとして表示する設定追加。 (設定 > 動画)
- ページとして表示された動画を制御するためののコントロール バーをナビゲーター パネルに追加。 (ナビゲーター パネル > 詳細メニュー)
- GIFアニメーション再生に AnimatedImage を使用するようにした。
- PNGアニメーション再生に対応。

#### 基底スケール

- 基底スケール変更コマンドとマウスドラッグ操作を追加。
- 基底スケール値をブック単位で保存するようにした。

#### 自動回転

- 自動回転に強制左回転と強制右回転を追加。
- 自動回転設定をブック単位で保存するようにした。

#### その他

- 多くの不具合修正。
- アプリアイコン変更。
- ウィンドウ最大化の補正処理を変更。最大化時のウィンドウ枠幅設定廃止。
- ウィンドウ タイトルのキーワードに $FullPath を追加。
- チルトホイール操作によるスライダー方向による左右コマンド入れ替え設定追加。
- SusiePluginフォルダを相対パスで指定可能にした。
- パネルのサムネイル表示での操作を高速化。
- パネル幅をウィンドウ内に制限する設定を追加。 (設定 > パネル)
- パネルを水平接続可能にした。２つ目以降は現在の方向でのみの接続になります。
- パネルの日時フォーマットをカルチャ依存にした。 このフォーマットは設定可能です。 (設定 > 全般)
- パネル等でも可能であればマウスコマンドを受け付けるようにした。
- 自然順の並びをエクスプローラーの並びに近づけた。
- PNGに埋め込まれている追加のテキストを情報パネルの追加情報グループで表示できるようにした。
- 履歴を自動保存するようにした。
- 履歴リスト コンテンツ表示で履歴更新日時を表示するようにした。
- ページリストでのファイル名変更を実装。
- ZIP内のファイル削除に対応。 機能させるには設定でZIPファイル編集可能を有効にします。
- 画像出力にオリジナルサイズとドットキープの設定追加。
- ページ終端挙動にシームレスループを追加。
- スライドショー タイマーの精度向上。
- スライドショーにタイマー表示を追加。 (設定 > スライドショー)
- グリッドの対象を画像と画面と選択可能にした。
- ブックページのデザイン変更。サムネイルではなく画像をそのまま表示するようにした。
- ファイルコピー時のテキスト要素を基本無しにした。
- プレイリスト項目でもファイルのコピーができるようにした。
- スクリプト：互換性にレベル導入。パラメータ名変更等の動作に影響しない変更はコンソール通知だけになるようにした。
- スクリプト：nv.Playlist.Name 追加。 代入することで現在のプレイリストの名前を変更可能。
- スクリプト：PageAccessor に GetMetaValue メソッド追加。画像のメタ情報を取得できます。

----

これ以前の更新履歴は[こちら](https://bitbucket.org/neelabo/neeview/wiki/ChangeLog)を参照してください。
